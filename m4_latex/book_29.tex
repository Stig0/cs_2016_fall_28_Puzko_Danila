\documentclass[fleqn]{book}

%% Language and font encodings
\usepackage[english]{babel}
\usepackage[utf8x]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{fancyhdr}


%% Sets page size and margins
\usepackage[a4paper,top=2cm, bottom=2cm,left=3cm,right=3cm,marginparwidth=1.95cm]{geometry}
\usepackage{xcolor}

%% Useful packages
\usepackage{amsmath}
\usepackage{graphicx}
\usepackage[colorinlistoftodos]{todonotes}
\usepackage[colorlinks=true, allcolors=blue]{hyperref}
\usepackage{amssymb}
\usepackage{color}
\usepackage{setspace}



\setcounter{chapter}{6}
\setcounter{section}{3}
\newcounter{problem1}
\setcounter{problem1}{13}
\newcommand{\problem}{\par\addtocounter{problem1}{1}%
\textbf{Problem \arabic{chapter}.\arabic{problem1} }\quad}
\setcounter{equation}{7}
\setcounter{subsection}{1}


\begin{document}
\pagestyle{fancy}

\renewcommand{\headrulewidth}{0pt}
\fancyhf{}

\fancyhead[RO]{\large \textsl {\textbf{109}}}
\fancyhead[LO]{\large \textsl {6.3 Operators: Euler-MacLaurin summation}}


\colorbox{lightgray}{
\begin{minipage}{\textwidth}
\large{{\bf \problem  Continue the pattern}}


What is $e^Dx^3$ and, in general, $e^Dx^n$?
\\
\end{minipage}}
\\

\noindent \large $\blacktriangleright$ \textit{What does $e^D$ do in general?}
\\

\noindent \Large {The preceding examples follow the pattern $e^Dx^n = (x+1)^n$. Because most
functions of x can be expanded in powers of x, and $e^D$ turns each $x^n$ term
into $(x+1)^n$, the conclusion is that $e^D$ turns $f(x)$ into $f(x+1)$. Amazingly,
$e^D$ is simply L, the left-shift operator.}
\\

\colorbox{lightgray}{
\begin{minipage}{\textwidth}
\large{{\bf \problem Right or left shift}}
\vspace{0.1cm}

 \large{Draw a graph to show that $f(x) → f(x + 1)$ is a left rather than a right shift.} 
\vspace{0.1cm} Apply $e^{−D}$ to a few simple functions to characterize its behavior.
\\

\large{{\bf \problem Operating on a harder function}}
\vspace{0.1cm}

Apply the Taylor expansion for $e^D$ to $sin{x}$ to show that $e^Dsin x = sin(x + 1)$.
\\

\large{{\bf \problem General shift operator}}


If x has dimensions, then the derivative operator $D = d/dx$ is not dimensionless, and $e^D$ is an illegal expression. To make the general expression eaD legal, what must the dimensions of $a$ be? What does $e^{aD}$ do?
\end{minipage}}
\\
\\


\subsection {\Large Summation}



\noindent\Large 
{Just as the derivative operator can represent the left-shift operator (as $L =
e^D$), the left-shift operator can represent the operation of summation. This
operator representation will lead to a powerful method for approximating
sums with no closed form.
Summation is analogous to the more familiar operation of integration.
Integration occurs in definite and indefinite flavors: Definite integration
is equivalent to indefinite integration followed by evaluation at the limits
of integration. As an example, here is the definite integration of $f(x) = 2x$.}
\\


\hangindent=1.5cm {$2x$ $\longrightarrow$ $\underset{\textrm{integration}}{\fbox{\huge{$\int$}}}\xrightarrow{x^2+C}$ $\underset{\textrm{limits}}{\fbox{$\Big|_a^b$}}$} $\longrightarrow$ $b^2-a^2$ \vspace{0.5cm}


\noindent In general, the connection between an input function g and the result of
indefinite integration is $DG = g$, where $D$ is the derivative operator and
$G=\int g$ is the result of indefinite integration. Thus D and $\int$ are inverses\\



\newpage


\pagestyle{fancy}



\renewcommand{\headrulewidth}{0pt}
\fancyhf{}

\fancyhead[LO]{\large \textsl {\textbf{110}}}
\fancyhead[RO]{\large \textsl {6 Analogy}}
\noindent \Large {of one another---$D\int=1$ or $D=1/\int$---a connection represented by the loop in the diagram ($D\not=1$ because of a possible integration constant.)}
\\
\\
\\

\noindent \large $\blacktriangleright$ \textit{What is the analogous picture for summation?}
\\
\\
\noindent
\begin{minipage}[h]{70mm}\parindent=2em
\Large Analogously to integration, define definite summation as indefinite summation and then evaluation at the limits. But apply the analogy with care to avoid an off-by-one or
fencepost error (Problem 2.24). The sum  
\end{minipage} \\ 
$\sum\nolimits_2^4 f(k)$ \Large includes three rectangles—$f(2), f(3),$ and $f(4)$—whereas the definite integral $\int_{2}^{4}f(k)dk$ does not include any of the $f(4)$ rectangle. Rather than rectifying the discrepancy by redefining the familiar operation of integration, interpret indefinite summation to exclude the last rectangle.
Then indefinite summation followed by evaluating at the limits a and b produces a sum whose index ranges from $a$ to $b − 1$.
\\
\\
\Large As an example, take $f(k) = k$. Then the indefinite sum $\Sigma f$ is the function $F$ defined by $F(k) = k(k−1)/2+C$ (where C is the constant of summation). Evaluating $F$ between 0 and $n$ gives $n(n − 1)/2$, which is $\Sigma_0^{n-1}k$. In the following diagram, these steps are the forward path.
\\
\\
\\
\\
\\
\\
\\
In the reverse path, the new $\Delta$ operator inverts $\Sigma$ just as differentiation
inverts integration. Therefore, an operator representation for $\Delta$ provides
one for $\Sigma$. Because $\Delta$ and the derivative operator $D$ are analogous, their
representations are probably analogous. A derivative is the limit\\

\begin{equation}
\frac{df}{dx}=\lim_{h\rightarrow 0}\frac{f(x+h)-f(x)}{h}.
\end{equation}

\newpage
\pagestyle{fancy}


\renewcommand{\headrulewidth}{0pt}
\fancyhf{}

\fancyhead[RO]{\large \textsl {\textbf{111}}}
\fancyhead[LO]{\large \textsl {6.3 Operators: Euler-MacLaurin summation}}

\noindent The deretive operator $D$ is therefore the operator limit
\begin{equation}
D=\lim_{h\rightarrow 0}\frac{L_h-1}{h}, 
\end{equation}

where the $L_h$ operator turns $f(x)$ into $f(x+h)$---that is, $L_h$ left  shifts by h.\\

\colorbox{lightgray}{
\begin{minipage}{\textwidth}
\hangindent=3cm \large{{\bf \problem Operator limit}}
\vspace{0.1cm}

\large{Explain why $L_h\approx1+hD$ for small h. Show therefore that $L=e^D$}.
\end{minipage}}\\

\noindent \large $\blacktriangleright$ \textit{What is an analogous representation of $\Delta$?} \\

\Large \noindent The operator limit for $D$ uses an infinitesimal left shift; correspondingly,
the inverse operation of integration sums rectangles of infinitesimal width.
Because summation $\Sigma$ sums rectangles of unit width, its inverse $\Delta$ should
use a unit left shift—namely, $L_h$ with $h = 1$. As a reasonable conjecture,
\begin{equation}
\Delta=\lim_{h\rightarrow 1}\frac{L_h-1}{h}=L-1. 
\end{equation}

\noindent This $\Delta$---called the finite-difference operator—is constructed to be $1/\Sigma$. If the construction is correct, then $(L-1)\Sigma$ is the identity operator 1. In other words, $(L-1)\Sigma$ should turn functions into themselves.\\

\noindent \large $\blacktriangleright$ \textit{How well does this conjecture work in various easy cases?} \\

\Large \noindent To test the conjecture, apply the operator $(L-1)\Sigma$ first to the easy function $g = 1$. Then $\Sigma g$ g is a function waiting to be fed an argument, and $(\Sigma g)(k)$ is the result of feeding it $k$. With that notation, $(\Sigma g)(k)=k+C$. Feeding
this function to the $L−1$ operator reproduces $g$.
\begin{equation}
[(L-1)\Sigma g](k)=\underbrace{(k+1+C)}_{(L\Sigma g)(k)}-\underbrace{(k+C)}_{(1\Sigma g)(k)}=\underbrace{1}_{g(k)}.
\end{equation} \vspace{0.001cm}
With the next-easiest function—defined by $g(k)=k$---the indefinite sum $(\Sigma g)(k)$ is $k(k-1)/2+C$. Passing $\Sigma g$ through $L-1$ again reproduces $g$.
\begin{equation}
[(L-1)\Sigma g](k)=\underbrace{(\frac{(k+1)k}{2}+C)}_{(L\Sigma g)(k)}-\underbrace{(\frac{k(k-1)}{2}+C)}_{(1\Sigma g)(k)}=\underbrace{k}_{g(k)}. 
\end{equation} 

In summary, for the test functions $g(k) = 1$ and $g(k) = k$, the operator
product $(L − 1)\Sigma$ takes $g$ back to itself, so it acts like the identity operator.

\newpage

\pagestyle{fancy}

\renewcommand{\headrulewidth}{0pt}
\fancyhf{}

\fancyhead[LO]{\large \textsl {\textbf{112}}}
\fancyhead[RO]{\large \textsl {6 Analogy}}

\noindent \Large This behavior is general---$(L-1)\Sigma 1$ is indeed 1, and $\Sigma=1/(L-1)$. Because $L=e^D$, we have $\Sigma=1/(e^D-1)$. Expanding the right side in a Taylor
series gives an amazing representation of the summation operator.
\begin{equation}
\sum=\frac{1}{e^D-1}=\frac{1}{D}-\frac{1}{2}+\frac{D}{12}-\frac{D^3}{720}+\frac{D^5}{30240}-\dots. 
\end{equation}
Because $D\int=1$, the leading term $1/D$ is integration. Thus, summation is approximately integration—a plausible conclusion indicating that the operator representation is not nonsense.\\

\noindent Applying this operator series to a function f and then evaluating at the limits $a$ and $b$ produces the Euler–MacLaurin summation formula

\begin{eqnarray}
\sum_a^{b-1}f(k)=\int_a^b f(k)dk-\frac{f(b)-f(a)}{2}+\frac{f^{(1)}(b)-f^{(1)}(a)}{12}\nonumber \\
-\frac{f^{(3)}(b)-f^{(3)}(a)}{720}+\frac{f^{(5)}(b)-f^{(5)}(a)}{30240}-\dots.
\end{eqnarray}
where $f^{(n)}$ indicates the nth derivative of $f$.
\vspace{0.2cm}

\noindent The sum lacks the usual final term $f(b)$. Including this term gives the useful alternative 
\begin{eqnarray}
\sum_a^{b}f(k)=\int_a^b f(k)dk+\frac{f(b)-f(a)}{2}+\frac{f^{(1)}(b)-f^{(1)}(a)}{12}\nonumber\\
-\frac{f^{(3)}(b)-f^{(3)}(a)}{720}+\frac{f^{(5)}(b)-f^{(5)}(a)}{30240}-\dots. 
\end{eqnarray}


\noindent As a check, try an easy case: $\sum_0^n k$. Using Euler–MacLaurin summation, $f(k)=k$, $a=0$, and $b=n$. The integral term then contributes $n^2/2$; the constant term $[f(b)+f(a)]/2$ contributes $n/2$; and later terms vanish. The result is familiar and correct:

\begin{equation}
\sum_0^n k=\frac{n^2}{2}+\frac{n}{2}+0=\frac{n(n+1)}{2}.
\end{equation}

\noindent A more stringent test of Euler–MacLaurin summation is to approximate $\ln{n!}$, which is the sum $\sum_1^n\ln k$(Section 4.5). Therefore, sum $f(k)=\ln k$ between the (inclusive) limits $a=1$ and $b=n$. The result is

\begin{equation}
\sum_1^n\ln k=\int_1^n\ln k dk+\frac{\ln n}{2}+\dots.
\end{equation}




\end{document}
